{% extends 'base.html' %} {% block content %}
<div style="max-width: 950px; margin: auto; padding-bottom: 50px">
  <h2 style="color: #2d5a27; margin-bottom: 30px">Your Swap Dashboard ðŸ“Š</h2>

  <h3 style="margin-top: 30px; color: #333">
    Requests for Your Items (Incoming)
  </h3>
  <table
    style="
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      margin-bottom: 40px;
    "
  >
    <tr style="background: #2d5a27; color: white; text-align: left">
      <th style="padding: 15px">Item</th>
      <th style="padding: 15px">From User</th>
      <th style="padding: 15px">Status</th>
      <th style="padding: 15px">Action</th>
    </tr>
    {% for req in incoming %}
    <tr style="border-bottom: 1px solid #eee">
      <td style="padding: 15px"><strong>{{ req.item.title }}</strong></td>
      <td style="padding: 15px">{{ req.sender.username }}</td>
      <td style="padding: 15px">
        <span
          style="text-transform: capitalize; font-weight: bold; color: {% if req.status == 'accepted' %}#28a745{% elif req.status == 'rejected' %}#dc3545{% else %}#ffc107{% endif %}"
        >
          {{ req.status }}
        </span>
      </td>
      <td style="padding: 15px">
        {% if req.status == 'pending' %}
        <a
          href="{% url 'update_status' req.id 'accepted' %}"
          style="
            color: white;
            background: #28a745;
            padding: 5px 10px;
            border-radius: 4px;
            text-decoration: none;
            font-size: 14px;
            margin-right: 5px;
          "
          >Accept</a
        >
        <a
          href="{% url 'update_status' req.id 'rejected' %}"
          style="
            color: white;
            background: #dc3545;
            padding: 5px 10px;
            border-radius: 4px;
            text-decoration: none;
            font-size: 14px;
          "
          >Reject</a
        >
        {% else %}
        <span style="color: #888; font-style: italic">Process Complete</span>
        {% endif %}
      </td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="4" style="padding: 30px; text-align: center; color: #888">
        No incoming requests yet.
      </td>
    </tr>
    {% endfor %}
  </table>

  <h3 style="margin-top: 50px; color: #333">Requests You Sent (Outgoing)</h3>
  <table
    style="
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    "
  >
    <tr style="background: #555; color: white; text-align: left">
      <th style="padding: 15px">Item Requested</th>
      <th style="padding: 15px">Owner</th>
      <th style="padding: 15px">Current Status</th>
      <th style="padding: 15px">Contact Info</th>
    </tr>
    {% for req in outgoing %}
    <tr style="border-bottom: 1px solid #eee">
      <td style="padding: 15px"><strong>{{ req.item.title }}</strong></td>
      <td style="padding: 15px">{{ req.item.owner.username }}</td>
      <td style="padding: 15px">
        <span
          style="text-transform: capitalize; padding: 5px 12px; border-radius: 20px; font-size: 13px; font-weight: bold; 
          {% if req.status == 'accepted' %} background: #d4edda; color: #155724; 
          {% elif req.status == 'rejected' %} background: #f8d7da; color: #721c24; 
          {% else %} background: #fff3cd; color: #856404; {% endif %}"
        >
          {{ req.status }}
        </span>
      </td>
      <td style="padding: 15px">
        {% if req.status == 'accepted' %}
        <span style="color: #2d5a27"
          >Email: {{ req.item.owner.email|default:"N/A" }}</span
        >
        {% elif req.status == 'rejected' %}
        <span style="color: #999">Better luck next time!</span>
        {% else %}
        <span style="color: #999">Waiting for response...</span>
        {% endif %}
      </td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="4" style="padding: 30px; text-align: center; color: #888">
        You haven't requested any items yet.
      </td>
    </tr>
    {% endfor %}
  </table>
</div>
{% endblock %}
